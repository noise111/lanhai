<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
    <title>{$_W['page']['title']}</title>
    <script src="//res.wx.qq.com/open/js/jweixin-1.3.2.js"></script>
    <script src="../addons/xfeng_community/template/mobile/default2/static/js/jquery-2.1.4.js"></script>
    <script src="../addons/xfeng_community/template/mobile/default2/static/js/fastclick.js"></script>
    <script>
        $(function() {
        FastClick.attach(document.body);
      });
    </script>
    
    <script src="../addons/xfeng_community/libs/js/axios/0.16.2/axios.min.js"></script> 
    <script src="../addons/xfeng_community/template/mobile/default2/static/js/swiper.min.js"></script>
    <script src="../addons/xfeng_community/template/mobile/default2/static/js/swiper4.min.js"></script>
    <script src="../addons/xfeng_community/template/mobile/default2/static/js/jquery-weui.js"></script>
    
    <link rel="stylesheet" type="text/css" href="../addons/xfeng_community/template/mobile/default2/static/css/swiper.css">
    <link rel="stylesheet" type="text/css" href="../addons/xfeng_community/template/mobile/default2/static/css/jquery-weui.css">
    <link rel="stylesheet" type="text/css" href="../addons/xfeng_community/template/mobile/default2/static/css/weuix.css">

    <link href="/addons/xfeng_community/template/mobile/default2/plugin/static/css/vendor.css?26317966ae924596e0b8" rel="stylesheet">
    <link href="/addons/xfeng_community/template/mobile/default2/plugin/static/css/mobile/activity/list.css?26317966ae924596e0b8" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="../addons/xfeng_community/template/mobile/default2/static/css/main.css">
    <link rel="stylesheet" type="text/css" href="../addons/xfeng_community/template/mobile/default2/static/css/activity.css">

    <script type="text/javascript">
        var _hmt = _hmt || [];
        // window.settings = {php echo json_encode($this->settings, JSON_UNESCAPED_UNICODE);};
        // jssdk config å¯¹è±¡
        jssdkconfig = {php echo json_encode($_W['account']['jssdkconfig']);} || {};
        // æ˜¯å¦å¯ç”¨è°ƒè¯•
        jssdkconfig.debug = false;
        jssdkconfig.jsApiList = [
            'checkJsApi',
            'onMenuShareTimeline',
            'onMenuShareAppMessage',
            'onMenuShareQQ',
            'onMenuShareWeibo',
            'hideMenuItems',
            'showMenuItems',
            'hideAllNonBaseMenuItem',
            'showAllNonBaseMenuItem',
            'translateVoice',
            'startRecord',
            'stopRecord',
            'onRecordEnd',
            'playVoice',
            'pauseVoice',
            'stopVoice',
            'uploadVoice',
            'downloadVoice',
            'chooseImage',
            'previewImage',
            'uploadImage',
            'downloadImage',
            'getNetworkType',
            'openLocation',
            'getLocation',
            'hideOptionMenu',
            'showOptionMenu',
            'closeWindow',
            'scanQRCode',
            'chooseWXPay',
            'openProductSpecificView',
            'addCard',
            'chooseCard',
            'openCard',
            'openAddress'
        ];
        wx.config(jssdkconfig);
        wx.ready(function () {
            // var sharedata = window.settings.share || null;
            var sharedata = {php echo json_encode($_share);};
            wx.onMenuShareAppMessage(sharedata);
            wx.onMenuShareTimeline(sharedata);
            wx.onMenuShareQQ(sharedata);
            wx.onMenuShareWeibo(sharedata);
        });
    </script>

</head>
<body style="background: #ffffff;">
<div style="height:100%;">
    <div class="weui-tab container">
        <div class="weui-tab__panel vux-fix-safari-overflow-scrolling">
            <!-- å¹»ç¯ç‰‡ -->
            <div class="swiper-container shouye">
                <div class="swiper-wrapper">

                </div>
                <div class="swiper-pagination"></div>
            </div>
            <!-- æ´»åŠ¨åˆ—è¡¨ -->
            <div class="activity_main">
                <div class="activity_title">
                    <a href="{php echo $this->createMobileUrl('activity',array('op'=>'list2'))}" >
                            <span>çº¿ä¸‹ä¸€èµ·èš</span>
                            <font>åƒå–ç©ä¹ä¸åœæ­‡</font>
                            <div class="r_jiantou"></div>
                    </a>
                </div>
                    <div class="activity_list">
                            <div class="activity_list_main" >
                                    <a  href="{php echo $this->createMobileUrl('activity',array('op'=>'detail','id'=>'7'))}" class="active-list">
                                        <div  class="active-item">
                                            <img  src="http://ming.ngrok.365safewalk.com/attachment/images/1/2018/11/VOivAAS0rj3GgfDfIY6nES6Eg2nbJk.png">
                                            <div  class="active-mask"></div>
                                            <p  class="active-tit">æµ‹è¯•æ´»åŠ¨1</p>
                                        </div>
                                        <div  class="active-fto">
                                            <span  class="active-number">10äººå·²æŠ¥å</span>
                                            <span >2019/02/19-2019/04/20</span>
                                        </div>
                                    </a>

                                    <a  href="{php echo $this->createMobileUrl('activity',array('op'=>'detail','id'=>'6'))}" class="active-list">
                                        <div  class="active-item">
                                            <img  src="http://ming.ngrok.365safewalk.com/attachment/images/1/2018/11/VOivAAS0rj3GgfDfIY6nES6Eg2nbJk.png">
                                            <div  class="active-mask"></div>
                                            <p  class="active-tit">æµ‹è¯•æ´»åŠ¨2</p>
                                        </div>
                                        <div  class="active-fto">
                                            <span  class="active-number">11äººå·²æŠ¥å</span>
                                            <span >2019/02/19-2019/04/20</span>
                                        </div>
                                    </a>
                            </div>
                    </div>
            </div>
            
            <!-- ä»–ä»¬éƒ½åœ¨è¯´ -->
            <div class="activity_title activity_title2" style="margin-top: 30px; margin-bottom: 0px;">
                <div class="activity_title2_left">
                        <span>TAä»¬éƒ½åœ¨è¯´</span>
                        <font>ä¸€äººï¼Œä¸€è¯­ï¼Œä¸€ä¸–ç•Œ</font>
                </div>
                <a class="activity_title2_right" href="{php echo $this->createMobileUrl('activity',array('op'=>'dynamicpost'))}" >
                        <span class="icon icon-116"></span>å‘å¸ƒåŠ¨æ€
                </a>
            </div>
            <div id="list">
                    <ul>
                        <li>
                            <div class="po-avt-wrap">
                                <img class="po-avt data-avt" src="http://thirdwx.qlogo.cn/mmopen/7BibuARgwtXd5KfWKd8X5GIsG54iaQTEmv6t5t7HNlcibKvsticKic5FvCdzEjKPiabP1uBS4evRwD0RHyhrqUoSVKLUAgMcHiby12M/132">
                            </div>
                            <div class="po-cmt">
                                <div class="po-hd">
                                    <p class="po-name">
                                        <span class="data-name">æŸæŸç§‘æŠ€~è´¾ç´ æ°</span>
                                        <span class="time">
                                                1åˆ†é’Ÿå‰
                                        </span>
                                    </p>
                                    <div class="post">
                                        <p>å¤§å®¶å¥½ï¼Œå¬è¯´å›½å†…å†»æˆç‹—ğŸ¶ï¼Ÿæˆ‘è¿™è¾¹è¿˜æŒºçƒ­ï½</p>
                                        <p>
                                            <img class="list-img" onclick="showBigImg('http://ming.ngrok.365safewalk.com/addons/xfeng_community/template/mobile/default2/static/images/jt1.jpg,http://ming.ngrok.365safewalk.com/addons/xfeng_community/template/mobile/default2/static/images/yt3.jpg',0)" src="../addons/xfeng_community/template/mobile/default2/static/images/jt1.jpg" style="height: 80px;">
                                            <img class="list-img" onclick="showBigImg('http://ming.ngrok.365safewalk.com/addons/xfeng_community/template/mobile/default2/static/images/jt1.jpg,http://ming.ngrok.365safewalk.com/addons/xfeng_community/template/mobile/default2/static/images/yt3.jpg',1)" src="../addons/xfeng_community/template/mobile/default2/static/images/yt3.jpg" style="height: 80px;">
                                        </p>
                                    </div>
                                    <!-- åªæœ‰æ˜¯è‡ªå·±å‘å¸ƒçš„æ‰å¯ä»¥åˆ é™¤ -->
                                    <span class="delete">åˆ é™¤</span>
                                    <!-- è¯„è®º -->
                                    <div class="comment">
                                        <span class="icon icon-79"></span>
                                    </div>
                                    <!-- ç‚¹èµ -->
                                    <div class="praise">
                                            <span id="praise"><span data-on="0" id="praise-icon" class="icon icon-65"></span></span>
                                            <span id="praise-txt">1455</span>
                                            <span id="add-num"><em>+1</em></span>
                                    </div>
                                </div>
                            </div>
                            <div class="r"></div>
                            <div class="cmt-wrap">
                                <div class="cmt-list">
                                    <p><span>wuä¸–å‹‹-EXOï¼š</span>ë‚˜ëŠ” ì„œëª…ï½</p>
                                    <p><span>é¹¿æ™—ï¼š</span>æˆ‘ä»¬åœ¨å›½å†…å†»æˆç‹—ï¼Œæˆ‘ä¹Ÿæƒ³è·Ÿå“¥æ‚¨å»çƒ­çƒ­ï½</p>
                                    <p><span>æƒå¿—é¾™ï¼š</span>ë‚˜ëŠ” ì„œëª…ï½</p>
                                    <p><span>ç‹æ€èªï¼š</span>å»å“ªç©å•Šï¼Ÿé‚£ä¹ˆçˆ½</p>
                                    <p>
                                        <span class="data-name">æŸæŸç§‘æŠ€~è´¾ç´ æ°</span>
                                        å›å¤
                                                <span>
                                                    ç‹æ€èª
                                                </span>
                                                <span>
                                                    ï¼š
                                                </span>
                                        æ¾³æ´²å¤§å ¡ç¤ï¼Œè¿™è¾¹åˆšå¥½æ˜¯å¤å­£ï¼ŒæŒºé€‚åˆé¿å¯’çš„ã€‚
                                    </p>
                                    <p><span>æ¨å¹‚ï¼š</span>ğŸ˜˜ç§äººé£æœºå‡ºè¡Œï¼Œæ±‚å¸¦ä¸Šæˆ‘ï½</p>
                                </div>
                            </div>
                        </li>
                       
                 
                    </ul>
                </div>

                <div class="weui-loadmore" style="display:none">
                        <i class="weui-loading"></i>
                        <span class="weui-loadmore__tips">æ­£åœ¨åŠ è½½</span>
                </div>
            </div>
        <div  class="weui-tabbar">
        
            </div>
    </div>
</div>

<script>
$.showLoading("æ­£åœ¨åŠ è½½");
var loading = false;  //çŠ¶æ€æ ‡è®°
$('.vux-fix-safari-overflow-scrolling').infinite(50).on("infinite", function() {
  if(loading) return;
  loading = true;
  $('.weui-loadmore').show();
  setTimeout(function() {
    $("#list").append("<p> æˆ‘æ˜¯æ–°åŠ è½½çš„å†…å®¹ </p>");
    $('.weui-loadmore').hide();
    loading = false;
  }, 3000);   //æ¨¡æ‹Ÿå»¶è¿Ÿ
});

$(document).ready(function(){
    //åº•éƒ¨èœå•
    axios.get("{php echo $this->createMobileUrl('getFootersList',array('a'=>'wxapp'))}",
         {}) //ä¹Ÿå¯ä»¥ç›´æ¥æ‹¼æ¥åœ¨url
            .then(function(res){
                $.hideLoading();
                var err = res.data;
                if(err.err_code==0){
                    var html = '';
                    $.each(err.data,function(i,val){  
                        var _do = "{$_GPC['do']}";
                        if(val.url.indexOf(_do) != -1){
                            html += '<a  href="'+ val.url +'" class="weui-tabbar__item weui-bar__item_on">';
                            html += '<div class="weui-tabbar__icon">';
                            html += '<img  src="'+ val.clickIcon +'">';
                        }else{
                            html += '<a  href="'+ val.url +'" class="weui-tabbar__item ">';
                            html += '<div class="weui-tabbar__icon">';
                            html += '<img  src="'+ val.icon +'">';
                        }
                        html += '</div>';
                        html += '<p class="weui-tabbar__label"><span >'+val.title+'</span></p>';
                        html += '</div>';
                    })
                    $('.weui-tabbar').html(html);
                }
            })
            .catch(function(e){
                console.log('è¯·æ±‚postå¤±è´¥')
            });

            //å¹»ç¯ç‰‡
            axios.get("{php echo $this->createMobileUrl('display',array('a'=>'wxapp','op'=>'home'))}",
                 {}) //ä¹Ÿå¯ä»¥ç›´æ¥æ‹¼æ¥åœ¨url
                    .then(function(res){
                        $.hideLoading();
                        var err = res.data;
                        if(err.err_code==0){
                            $.each(err.data,function(i,val){  
                              if(val.component=='LnAdv'){
                                var html = '';
                                if(val.items.length>0){
                                    $.each(val.items,function(i2,val2){  
                                        html += '<div class="swiper-slide"><img src="/attachment/'+ val2.thumb +'"></div>';
                                    })
                                    $('.swiper-wrapper').html(html);
                                    var swiper = new Swiper('.swiper-container', {
                                        autoHeight: true, //enable auto height
                                        spaceBetween: 20,
                                        pagination: {
                                            el: '.swiper-pagination',
                                            clickable: true,
                                        },
                                        autoplay: {
                                            delay: 3000,
                                            stopOnLastSlide: false,
                                            disableOnInteraction: true,
                                        },
                                    });
                                }else{
                                    $('.swiper-container').remove();
                                }
                              }
                            })
                        }
                    })
                    .catch(function(e){
                        console.log('è¯·æ±‚postå¤±è´¥')
                    });

            //æ´»åŠ¨åˆ—è¡¨
            axios.get("{php echo $this->createMobileUrl('activity',array('a'=>'wxapp','op'=>'list'))}",
                 {}) //ä¹Ÿå¯ä»¥ç›´æ¥æ‹¼æ¥åœ¨url
                    .then(function(res){
                        $.hideLoading();
                        var err = res.data;
                        if(err.err_code==0){
                           
                        }
                    })
                    .catch(function(e){
                        console.log('è¯·æ±‚postå¤±è´¥')
                    });

        //ç‚¹èµ
        $('body').on('click','.praise',function(){
			var praise_icon = $(this).find('#praise-icon');
			var text_box = $(this).find('#add-num');
			var praise_txt = $(this).find('#praise-txt');
			var num=parseInt(praise_txt.text());
			if(praise_icon.attr("data-on") == '1'){ 
				praise_icon.removeClass("icon-38").addClass("icon-65").attr("data-on",'0');
				praise_txt.removeClass("hover");
				text_box.show().html("<em class='add-animation'>-1</em>");
				$(this).find(".add-animation").removeClass("hover");
				num -=1;
				praise_txt.text(num)
			}else{
				praise_icon.removeClass("icon-65").addClass("icon-38").attr("data-on",'1');
				praise_txt.addClass("hover");
				text_box.show().html("<em class='add-animation'>+1</em>");
				$(this).find(".add-animation").addClass("hover");
				num +=1;
				praise_txt.text(num)
			}
		});

        //ç‚¹å‡»åˆ é™¤
        $('body').on('click','.delete',function(){
			$.confirm({
                title: 'æç¤º',
                text: 'ç¡®å®šè¦åˆ é™¤æ­¤åŠ¨æ€å—ï¼Ÿ',
                onOK: function () {
                    //ç‚¹å‡»ç¡®è®¤
                    alert('åˆ é™¤äº†')
                },
                onCancel: function () {
                }
            });
		});

        //ç‚¹å‡»è¯„è®º
        $('body').on('click','.comment',function(){
            $.prompt({
                title: "è¾“å…¥è¯„è®º",
                onOK: function(text) {
                    alert(text)
                },
                onCancel: function() {
                    console.log("å–æ¶ˆäº†");
                },
                input: ''
            });
		});
})

//ç‚¹å‡»å›¾ç‰‡
function showBigImg(list,index) {
    
    imgList = list.split(',');//listæ˜¯ä¸€ä¸ªå›¾ç‰‡urlçš„å­—ç¬¦ä¸²ï¼Œä»¥â€˜ï¼Œâ€™åˆ†éš”çš„ï¼Œè¿™é‡ŒæŠŠå®ƒè½¬æ¢æˆæ•°ç»„å¯¹è±¡
    console.log(imgList)
    $.photoBrowser({
        items: imgList, //èµ‹å€¼
        initIndex: index, //å½“å‰ç‚¹å‡»çš„å›¾ç‰‡ä¸‹æ ‡
        onSlideChange: function(index) {
            console.log(this, index);
        },
        onOpen:function(){
            $(this.modal).css('z-index',6666); 
        },
        onClose: function() {
            console.log("onClose", this);
        }
    }).open();//è¿™é‡Œä¸€å®šè¦è¿™æ ·è°ƒç”¨ä¸€ä¸‹
    
}


</script>
</body>
</html>